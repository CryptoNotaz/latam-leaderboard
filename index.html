<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>LataMarketCap — Dexscreener</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>.transition-height{transition:height .2s ease}</style>
</head>
<body class="min-h-screen bg-gray-50 text-gray-900">
  <div class="max-w-5xl mx-auto px-3 sm:px-6 py-6">
    <header class="mb-6 text-center">
      <h1 class="text-2xl sm:text-3xl font-bold">LataMarketCap</h1>
    </header>

    <nav class="mb-4 flex justify-center sm:justify-start gap-2">
      <button id="tabCoins"    class="px-3 py-1.5 rounded-lg bg-black text-white">Coins</button>
      <button id="tabNfts"     class="px-3 py-1.5 rounded-lg bg-gray-200">NFTs</button>
      <button id="tabCreators" class="px-3 py-1.5 rounded-lg bg-gray-200">Creadores</button>
    </nav>

    <!-- COINS -->
    <section id="coins-section" class="grid gap-4 items-start">
      <div>
        <div class="flex items-center gap-3 mb-3 justify-center sm:justify-start">
          <button id="refreshBtn" class="px-4 py-2 rounded-xl bg-black text-white font-medium shadow hover:opacity-90 active:opacity-80">Actualizar</button>
          <span id="status" class="text-sm text-gray-600"></span>
        </div>
        <div class="overflow-x-auto bg-white rounded-2xl shadow">
          <table class="w-full table-auto text-xs sm:text-sm" id="table">
            <thead class="bg-gray-100 sticky top-0 z-10">
              <tr>
                <th class="w-6 px-2 py-2 sm:px-4 sm:py-3 text-left">#</th>
                <th class="px-2 py-2 sm:px-4 sm:py-3 text-left">Ticker</th>
                <th class="w-24 sm:w-36 px-2 py-2 sm:px-4 sm:py-3 text-right">Precio</th>
                <th class="w-14 sm:w-20 px-2 py-2 sm:px-4 sm:py-3 text-right">24h</th>
                <th class="w-24 sm:w-36 px-2 py-2 sm:px-4 sm:py-3 text-right">Market Cap</th>
              </tr>
            </thead>
            <tbody id="tbody"></tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- NFTs -->
    <section id="nfts-section" class="grid gap-4 items-start hidden">
      <div>
        <div class="flex items-center gap-3 mb-3 justify-center sm:justify-start">
          <button id="nftRefreshBtn" class="px-4 py-2 rounded-xl bg-black text-white font-medium shadow hover:opacity-90 active:opacity-80">Actualizar</button>
          <span id="nftStatus" class="text-sm text-gray-600"></span>
        </div>
        <div class="overflow-x-auto bg-white rounded-2xl shadow">
          <table class="w-full table-auto text-xs sm:text-sm">
            <thead class="bg-gray-100 sticky top-0 z-10">
              <tr>
                <th class="w-6 px-2 py-2 sm:px-4 sm:py-3 text-left">#</th>
                <th class="px-2 py-2 sm:px-4 sm:py-3 text-left">Colección</th>
                <th class="w-24 sm:w-28 px-2 py-2 sm:px-4 sm:py-3 text-right">Floor</th>
                <th class="w-20 sm:w-24 px-2 py-2 sm:px-4 sm:py-3 text-right">24h Vol</th>
                <th class="w-20 sm:w-24 px-2 py-2 sm:px-4 sm:py-3 text-right">Supply</th>
                <th class="w-24 sm:w-36 px-2 py-2 sm:px-4 sm:py-3 text-right">MC (floor)</th>
              </tr>
            </thead>
            <tbody id="nftTbody"></tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- CREADORES -->
    <section id="creators-section" class="grid gap-4 items-start hidden">
      <div>
        <div class="flex items-center gap-3 mb-3 justify-center sm:justify-start">
          <button id="creRefreshBtn" class="px-4 py-2 rounded-xl bg-black text-white font-medium shadow hover:opacity-90 active:opacity-80">Actualizar</button>
          <span id="creStatus" class="text-sm text-gray-600"></span>
        </div>
        <div class="overflow-x-auto bg-white rounded-2xl shadow">
          <table class="w-full table-auto text-xs sm:text-sm">
            <thead class="bg-gray-100 sticky top-0 z-10">
              <tr>
                <th class="w-6 px-2 py-2 sm:px-4 sm:py-3 text-left">#</th>
                <th class="px-2 py-2 sm:px-4 sm:py-3 text-left">Creador</th>
                <th class="w-20 sm:w-24 px-2 py-2 sm:px-4 sm:py-3 text-right">Seguidores</th>
                <th class="w-24 sm:w-28 px-2 py-2 sm:px-4 sm:py-3 text-right">Roles</th>
              </tr>
            </thead>
            <tbody id="creTbody"></tbody>
          </table>
        </div>
      </div>
    </section>

    <footer class="mt-10 text-xs text-gray-500">
      <div class="flex items-center gap-2 justify-center sm:justify-start">
        <img src="./v1ps-logo.png" alt="V1PS" class="w-4 h-4 rounded">
        <span>Powered by <a class="underline" href="https://x.com/V1PS_NFTs" target="_blank" rel="noopener">V1PS</a></span>
      </div>
    </footer>
  </div>

<script>
  // ---------- Helpers comunes ----------
  const USD_QUOTES = ['USD','USDC','USDT','DAI','USD1','USDE','USDX'];
  const fmtNum = (n,max=2)=>new Intl.NumberFormat('en-US',{maximumFractionDigits:max}).format(n);
  const fmtUsd = (n)=>new Intl.NumberFormat('en-US',{style:'currency',currency:'USD',maximumFractionDigits:2}).format(n);
  const fmtUsdSmart=(n)=>{const o={style:'currency',currency:'USD'};if(Math.abs(n)>=1){o.minimumFractionDigits=2;o.maximumFractionDigits=2}else{o.minimumFractionDigits=5;o.maximumFractionDigits=5}return new Intl.NumberFormat('en-US',o).format(n)};
  const fmtUsdCompact=(n)=>{try{return new Intl.NumberFormat('en-US',{style:'currency',currency:'USD',notation:'compact',maximumFractionDigits:2}).format(n)}catch{const a=Math.abs(n);const u=[['T',1e12],['B',1e9],['M',1e6],['K',1e3]];for(const[s,v]of u)if(a>=v)return'$'+(n/v).toFixed(2)+s;return fmtUsd(n)}};
  const toNum=(v)=>{if(v==null)return null;const n=Number(String(v).replace(/[^0-9.]/g,''));return Number.isFinite(n)?n:null};

  // ---------- Coins ----------
  const tbody=document.getElementById('tbody');
  const refreshBtn=document.getElementById('refreshBtn');
  const statusEl=document.getElementById('status');
  const REFRESH_MS=60000;

  const lamportsToSOL=(x)=>(typeof x==='number'?x/1e9:null);
  const fmtSol=(n)=>n==null?'—':`◎${(Math.abs(n)>=1?n.toFixed(2):n.toFixed(3))}`;
  const fmtSolCompact=(n)=>n==null?'—':`◎${(Math.abs(n)>=1000?(n/1000).toFixed(1)+'K':(Math.abs(n)>=1?n.toFixed(2):n.toFixed(3)))}`;

  function getXUrl(info){
    const s=info?.socials||[];
    const byType=s.find(t=>/twitter|x/i.test(t?.type||t?.platform||'')); if(byType?.url) return byType.url;
    const byUrl=s.find(t=>/twitter\.com|x\.com/i.test(t?.url||''));     return byUrl?.url||null;
  }

  async function loadTokenList(){
    try{
      const r=await fetch('./tokens.json?ts='+Date.now(),{cache:'no-store'});
      if(!r.ok) throw new Error('No tokens.json');
      const list=await r.json();
      return list.map(x=>({chain:(x.chain||'solana').toLowerCase(),address:x.address}));
    }catch(e){
      console.warn('tokens.json no disponible, usando demo',e);
      statusEl.textContent='Usando lista demo; sube tokens.json';
      return [
        {"chain":"solana","address":"BS7HxRitaY5ipGfbek1nmatWLbaS9yoWRSEQzCb3pump"},
        {"chain":"solana","address":"DsMWZg6mkheTV2XTkbUtWcsXaajTzEkk1TC7o6Fmpump"},
        {"chain":"solana","address":"9Uxjbn2TyfEmjaYs1qXiLt3FbE3VDa5UMkvQGZwQpump"},
        {"chain":"solana","address":"9RLoB3YZwk9sK78ZhmiSAj8CtPhssuJR1pVR326Vpump"}
      ];
    }
  }
  function groupByChain(items){const m=new Map();for(const it of items){if(!m.has(it.chain))m.set(it.chain,[]);m.get(it.chain).push(it.address)}return m}
  function chooseBestPairs(pairs){
    const best=new Map();
    for(const p of pairs){
      const base=p?.baseToken?.address; if(!base) continue;
      const qSym=(p.quoteToken?.symbol||'').toUpperCase();
      const isUsd=USD_QUOTES.some(u=>qSym.includes(u));
      const liq=p.liquidity?.usd??0; const vol=p.volume?.h24??0;
      const score=(isUsd?1:0)*1e12+liq*1e6+vol;
      const prev=best.get(base); if(!prev||score>prev.__score){p.__score=score;best.set(base,p)}
    }
    return [...best.values()];
  }
  async function fetchByChain(chain,addresses){
    const chunk=(arr,n)=>arr.length?[arr.slice(0,n),...chunk(arr.slice(n),n)]:[];
    const chunks=chunk(addresses,30); const out=[];
    for(const addrs of chunks){
      const url=`https://api.dexscreener.com/tokens/v1/${encodeURIComponent(chain)}/${addrs.join(',')}`;
      const r=await fetch(url,{headers:{accept:'application/json'}}); if(!r.ok) throw new Error('Dexscreener '+r.status);
      out.push(...await r.json());
    }
    return out;
  }
  async function fetchAll(lines){
    const groups=groupByChain(lines);
    const arrays=await Promise.all([...groups.entries()].map(([chain,addrs])=>fetchByChain(chain,addrs)));
    return chooseBestPairs(arrays.flat());
  }
  function render(rows){
    tbody.innerHTML='';
    const tokens=rows.map(p=>({name:p.baseToken?.name||'—',symbol:(p.baseToken?.symbol||'').toUpperCase(),address:p.baseToken?.address||'',imageUrl:p.info?.imageUrl||'',priceUsd:p.priceUsd?Number(p.priceUsd):null,mc:(typeof p.marketCap==='number'?p.marketCap:null),fdv:(typeof p.fdv==='number'?p.fdv:null),liq:p.liquidity?.usd??null,change24:p.priceChange?.h24??null,xUrl:getXUrl(p.info),chainId:p.chainId,url:p.url}));
    tokens.sort((a,b)=>((b.mc??b.fdv??0)-(a.mc??a.fdv??0)));
    tokens.forEach((t,i)=>{
      const tr=document.createElement('tr'); tr.className='group cursor-pointer hover:bg-gray-50 leading-tight';
      const chg=t.change24; const chgClass=chg==null?'':(chg>=0?'text-green-600':'text-red-600'); const cap=t.mc??t.fdv; const badge=t.mc!=null?'MC':(t.fdv!=null?'FDV':'—');
      tr.innerHTML=`
        <td class="w-6 px-2 py-2 sm:px-4 sm:py-3 text-gray-500">${i+1}</td>
        <td class="px-2 py-2 sm:px-4 sm:py-3">
          <div class="flex items-center gap-1.5 sm:gap-2 min-w-0">
            ${t.imageUrl?`<img src="${t.imageUrl}" class="w-5 h-5 rounded-full"/>`:''}
            <span class="font-semibold truncate lp-copy" data-copy="${t.address||''}" title="Mantén presionado para copiar CA">${t.symbol||t.name}</span>
            <span class="inline-flex text-[10px] px-1.5 py-0.5 rounded bg-gray-200">${t.chainId}</span>
            ${t.url?`<a href="${t.url}" class="hidden md:inline-flex items-center justify-center w-6 h-6 rounded hover:bg-gray-200" title="Ver en Dexscreener">↗</a>`:''}
            ${t.xUrl?`<a href="${t.xUrl}" class="hidden md:inline-flex items-center justify-center w-6 h-6 rounded hover:bg-gray-200" title="X / Twitter"><svg viewBox="0 0 24 24" class="w-3.5 h-3.5" fill="currentColor"><path d="M18.244 3.515h3.167l-6.92 7.91 8.11 9.06H19.21l-5.66-6.328-6.465 6.328H3.917l7.405-7.245-7.87-8.726h4.04l5.157 5.723 5.595-5.723Zm-1.112 16.01h1.755L7.94 5.864H6.06l11.072 13.662Z"/></svg></a>`:''}
          </div>
        </td>
        <td class="w-28 sm:w-36 px-2 py-2 sm:px-4 sm:py-3 text-right whitespace-nowrap">${t.priceUsd!=null?fmtUsdSmart(t.priceUsd):'—'}</td>
        <td class="w-16 sm:w-20 px-2 py-2 sm:px-4 sm:py-3 text-right whitespace-nowrap ${chgClass}">${chg!=null?fmtNum(chg,2)+'%':'—'}</td>
        <td class="w-24 sm:w-36 px-2 py-2 sm:px-4 sm:py-3 text-right whitespace-nowrap"><span class="md:hidden">${cap!=null?fmtUsdCompact(cap):'—'}</span><span class="hidden md:inline">${cap!=null?fmtUsd(cap):'—'} <span class="ml-1 text-[10px] px-1 py-0.5 rounded bg-gray-100 border">${badge}</span></span></td>`;
      tbody.appendChild(tr);

      const det=document.createElement('tr'); det.className='details hidden bg-white/70';
      det.innerHTML=`<td colspan="5" class="px-4 py-3">
        <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-3 text-xs text-gray-700">
          <div class="md:col-span-4 flex items-center gap-2 text-sm">${t.imageUrl?`<img src="${t.imageUrl}" class="w-5 h-5 rounded-full"/>`:''}<span class="font-semibold">${t.name||'—'}</span><span class="text-xs text-gray-500 uppercase">${t.symbol}</span><span class="text-[10px] px-1.5 py-0.5 rounded bg-gray-200">${t.chainId}</span></div>
          <div class="md:col-span-4 flex flex-wrap items-center gap-2"><span class="font-medium">CA:</span> <code class="font-mono text-xs sm:text-[13px] break-all md:whitespace-nowrap select-all">${t.address||'—'}</code></div>
        </div>
      </td>`;
      tbody.appendChild(det);
    });
  }
  async function refresh(){try{statusEl.textContent='Cargando…';const list=await loadTokenList();if(!list.length){tbody.innerHTML='';statusEl.textContent='Agrega tokens a tokens.json';return}const pairs=await fetchAll(list);render(pairs);statusEl.textContent=`Actualizado: ${new Date().toLocaleTimeString()} · Auto 60s`}catch(e){console.error(e);statusEl.textContent='Error al actualizar.'}}
  refreshBtn.addEventListener('click',refresh); refresh(); setInterval(refresh,REFRESH_MS);

  // ---------- NFTs ----------
  const nftTbody=document.getElementById('nftTbody');
  const nftStatus=document.getElementById('nftStatus');
  const nftRefreshBtn=document.getElementById('nftRefreshBtn');
  const NFT_REFRESH_MS=5*60*1000; let nftTimer=null;
  const ME_PROXY='https://latamcap-me.cryptonotaz.workers.dev';
  const XINFO_PROXY='https://latamcap-me.cryptonotaz.workers.dev/x';

  const NFTS_FALLBACK=[{chain:'solana',source:'magiceden',slug:'v1ps',name:'V1PS',image:'./v1ps-logo.png'}];
  const slugFromUrl=(url)=>{if(!url) return null;const m=url.match(/\/marketplace\/([^\/?#]+)/i);return m?m[1]:null};
  async function loadNftList(){
    try{
      const r=await fetch('./nfts.json?ts='+Date.now(),{cache:'no-store'}); if(!r.ok) throw 0;
      const raw=await r.json(); if(!Array.isArray(raw)) throw 0;
      return raw.map(it=>({...it,slug:it.slug||slugFromUrl(it.url)||'',supply:toNum(it.supply),floorSOL:toNum(it.floorSOL),listed:toNum(it.listed),vol24hSOL:toNum(it.vol24hSOL)})).filter(x=>x.slug);
    }catch{ return NFTS_FALLBACK }
  }
  async function fetchSolPrice(){try{const r=await fetch('https://price.jup.ag/v6/price?ids=SOL');const j=await r.json();return j?.data?.SOL?.price??null}catch{return null}}
  async function fetchFromProxy(slugs){const r=await fetch(`${ME_PROXY}?slugs=${encodeURIComponent(slugs.join(','))}`,{headers:{accept:'application/json'}});if(!r.ok) throw 0;return await r.json()}
  async function fetchNftsAll(list){
    const slugs=list.map(it=>it.slug); let proxy={};
    try{proxy=await fetchFromProxy(slugs)}catch{}
    const rows=list.map(cfg=>{const d=proxy[cfg.slug]||{};const floorSOL=(cfg.floorSOL!=null?cfg.floorSOL:lamportsToSOL(d.floorLamports));const listed=(cfg.listed!=null?cfg.listed:toNum(d.listed));const vol24hSOL=(cfg.vol24hSOL!=null?cfg.vol24hSOL:lamportsToSOL(d.vol24hLamports));const supply=(cfg.supply!=null?cfg.supply:toNum(d.supply));return{slug:cfg.slug,name:cfg.name||d.name||cfg.slug,image:cfg.image||d.image||'',floorSOL,listed,vol24hSOL,supply,links:cfg.links||d.links||{me:`https://magiceden.io/marketplace/${cfg.slug}`}}});
    const anyFloor=rows.some(r=>typeof r.floorSOL==='number'); const solUsd=anyFloor?await fetchSolPrice():null;
    return rows.map(x=>({...x,floorUSD:(solUsd&&typeof x.floorSOL==='number')?x.floorSOL*solUsd:null,mcFloorUSD:(solUsd&&typeof x.floorSOL==='number'&&typeof x.supply==='number')?x.floorSOL*solUsd*x.supply:null}));
  }
  function renderNfts(rows){
    nftTbody.innerHTML='';
    rows.forEach((c,i)=>{
      const mc=c.mcFloorUSD??null;
      const tr=document.createElement('tr');tr.className='group cursor-pointer hover:bg-gray-50 leading-tight';
      tr.innerHTML=`<td class="w-6 px-2 py-2 sm:px-4 sm:py-3 text-gray-500">${i+1}</td>
      <td class="px-2 py-2 sm:px-4 sm:py-3"><div class="flex items-center gap-2 min-w-0">${c.image?`<img src="${c.image}" class="w-5 h-5 rounded"/>`:''}<span class="font-semibold truncate">${c.name}</span></div></td>
      <td class="w-24 sm:w-28 px-2 py-2 sm:px-4 sm:py-3 text-right whitespace-nowrap">${fmtSol(c.floorSOL)} ${c.floorUSD?`<span class='text-gray-500'>(${fmtUsd(c.floorUSD)})</span>`:''}</td>
      <td class="w-20 sm:w-24 px-2 py-2 sm:px-4 sm:py-3 text-right whitespace-nowrap">${fmtSolCompact(c.vol24hSOL)}</td>
      <td class="w-20 sm:w-24 px-2 py-2 sm:px-4 sm:py-3 text-right whitespace-nowrap">${c.supply!=null?fmtNum(c.supply,0):'—'}</td>
      <td class="w-24 sm:w-36 px-2 py-2 sm:px-4 sm:py-3 text-right whitespace-nowrap">${mc!=null?fmtUsdCompact(mc):'—'}</td>`;
      nftTbody.appendChild(tr);
    });
  }
  async function nftRefresh(){try{nftStatus.textContent='Cargando…';const list=await loadNftList();if(!list.length){nftTbody.innerHTML='';nftStatus.textContent='Agrega colecciones a nfts.json';return}const rows=await fetchNftsAll(list);rows.sort((a,b)=>(b.mcFloorUSD??0)-(a.mcFloorUSD??0));renderNfts(rows);nftStatus.textContent=`Actualizado: ${new Date().toLocaleTimeString()} · Auto 5m`}catch(e){console.error(e);nftStatus.textContent='Error al actualizar NFTs.'}}
  nftRefreshBtn.addEventListener('click',nftRefresh);

  // ---------- Creadores ----------
  const creTbody=document.getElementById('creTbody');
  const creStatus=document.getElementById('creStatus');
  const creRefreshBtn=document.getElementById('creRefreshBtn');
  const CREATORS_REFRESH_MS=60*60*1000; let creTimer=null;

  const sumFollowers=(f={})=>['x','github','telegram','youtube','tiktok','instagram'].map(k=>Number(f[k]||0)).reduce((a,b)=>a+b,0);
  function handleFromXUrl(url){if(!url) return null;const m=String(url).match(/(?:x\.com|twitter\.com)\/([^\/?#]+)/i);return m?m[1].replace(/^@/,''):null}
  async function fetchXInfo(handles){
    const list=[...new Set(handles)].filter(Boolean); if(!list.length) return {};
    const r=await fetch(`${XINFO_PROXY}?handles=${encodeURIComponent(list.join(','))}`,{headers:{accept:'application/json'}});
    if(!r.ok) return {};
    return await r.json();
  }
  async function loadCreators(){try{const r=await fetch('./creators.json?ts='+Date.now(),{cache:'no-store'});if(!r.ok) throw 0;const a=await r.json();return Array.isArray(a)?a:[]}catch{return[]}}
  async function fetchCreatorsAll(list){
    const handles=list.map(c=>handleFromXUrl(c.x)).filter(Boolean);
    let info={}; try{info=await fetchXInfo(handles)}catch{}
    return list.map(c=>{
      const h=handleFromXUrl(c.x)||''; const xi=info[h?.toLowerCase()]||{};
      return {
        name: c.name||xi.name||h||'—',
        x: c.x || (h?`https://x.com/${h}`:null),
        avatar: c.avatar||xi.avatar||null,
        roles: c.roles||[],
        followers:{x: toNum(xi.followers) ?? toNum(c.followers?.x) ?? 0},
        bio: c.bio||''
      }
    });
  }
  function renderCreators(rows){
    creTbody.innerHTML='';
    rows.forEach((c,i)=>{
      const total=sumFollowers(c.followers);
      const tr=document.createElement('tr');tr.className='group cursor-pointer hover:bg-gray-50 leading-tight';
      tr.innerHTML=`<td class="w-6 px-2 py-2 sm:px-4 sm:py-3 text-gray-500">${i+1}</td>
      <td class="px-2 py-2 sm:px-4 sm:py-3"><div class="flex items-center gap-2 min-w-0">${c.avatar?`<img src="${c.avatar}" class="w-6 h-6 rounded-full"/>`:''}<span class="font-semibold truncate">${c.name}</span>${c.x?`<a class="inline-flex items-center justify-center w-6 h-6 rounded hover:bg-gray-200" target="_blank" rel="noopener" href="${c.x}" title="Perfil en X"><svg viewBox="0 0 24 24" class="w-3.5 h-3.5" fill="currentColor"><path d="M18.244 3.515h3.167l-6.92 7.91 8.11 9.06H19.21l-5.66-6.328-6.465 6.328H3.917l7.405-7.245-7.87-8.726h4.04l5.157 5.723 5.595-5.723Zm-1.112 16.01h1.755L7.94 5.864H6.06l11.072 13.662Z"/></svg></a>`:''}</div></td>
      <td class="w-20 sm:w-24 px-2 py-2 sm:px-4 sm:py-3 text-right whitespace-nowrap">${fmtNum(total||c.followers?.x||0,0)}</td>
      <td class="w-24 sm:w-28 px-2 py-2 sm:px-4 sm:py-3 text-right whitespace-nowrap">${(c.roles||[]).join(', ')||'—'}</td>`;
      creTbody.appendChild(tr);
    });
  }
  async function creRefresh(){try{creStatus.textContent='Cargando…';const base=await loadCreators();if(!base.length){creTbody.innerHTML='';creStatus.textContent='Agrega perfiles a creators.json';return}const rows=await fetchCreatorsAll(base);rows.sort((a,b)=>(b.followers?.x||0)-(a.followers?.x||0));renderCreators(rows);creStatus.textContent=`Actualizado: ${new Date().toLocaleTimeString()} · Auto 1h`}catch(e){console.error(e);creStatus.textContent='Error al actualizar creadores.'}}
  creRefreshBtn.addEventListener('click',creRefresh);

  // ---------- Tabs ----------
  const tabCoins=document.getElementById('tabCoins');
  const tabNfts=document.getElementById('tabNfts');
  const tabCreators=document.getElementById('tabCreators');
  const coinsSection=document.getElementById('coins-section');
  const nftsSection=document.getElementById('nfts-section');
  const creatorsSection=document.getElementById('creators-section');

  function setActiveTab(tab){
    coinsSection.classList.toggle('hidden',tab!=='coins');
    nftsSection.classList.toggle('hidden',tab!=='nfts');
    creatorsSection.classList.toggle('hidden',tab!=='creators');
    const on=['bg-black','text-white'], off=['bg-gray-200'];
    [tabCoins,tabNfts,tabCreators].forEach(b=>b.classList.remove(...on,...off));
    (tab==='coins'?tabCoins:tab==='nfts'?tabNfts:tabCreators).classList.add(...on);
    (tab!=='coins'?tabCoins:tabNfts).classList.add(...off); if(tab!=='creators')tabCreators.classList.add(...off);
    clearInterval(nftTimer); clearInterval(creTimer);
    if(tab==='nfts'){ if(!window.__nftInit){nftRefresh();window.__nftInit=true} nftTimer=setInterval(nftRefresh,NFT_REFRESH_MS) }
    if(tab==='creators'){ if(!window.__creInit){creRefresh();window.__creInit=true} creTimer=setInterval(creRefresh,CREATORS_REFRESH_MS) }
  }
  tabCoins.addEventListener('click',()=>setActiveTab('coins'));
  tabNfts.addEventListener('click',()=>setActiveTab('nfts'));
  tabCreators.addEventListener('click',()=>setActiveTab('creators'));

  // init
  setActiveTab('coins');
</script>
</body>
</html>



